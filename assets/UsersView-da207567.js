import{a9 as S,x as s,ab as U,al as A,c as t,ad as o,ap as I,a0 as L,ag as T,aJ as D,V as F,aq as K,aK as N,aL as J,ah as m,ar as j,ao as q,ae as z,as as E,J as h,av as H,ai as O}from"./index-2e906d0c.js";import{a as $}from"./vee-validate.esm-018bef8b.js";import{V as G}from"./VContainer-451776cb.js";import{V as x}from"./VCol-dc2434c8.js";import{V as M}from"./VDataTableServer-947aec2b.js";import"./VDataTable-8815a807.js";import"./VList-5a36ea62.js";import"./VDivider-bdd82a0d.js";import"./VMenu-d82125ac.js";const Q=H("h1",{class:"text-center"},"會員管理",-1),le={__name:"UsersView",setup(R){const{apiAuth:V}=O(),p=S(),v=s(!1),C=s(""),w=$("account"),B=async()=>{var n,a;try{await V.delete("/users/"+C.value),p({text:"刪除成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"back",location:"bottom"}}),r()}catch(e){console.log(e);const d=((a=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:a.message)||"發生錯誤，請稍後再試";p({text:d,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"secondary",location:"bottom"}})}},g=s(10),u=s([{key:"createdAt",order:"desc"}]),c=s(1),f=s([]),P=[{title:"頭像",align:"center",sortable:!1,key:"avatar"},{title:"帳號",align:"center",sortable:!0,key:"account"},{title:"信箱",align:"center",sortable:!0,key:"email"}],b=s(!0),y=s(0),i=s(""),r=async()=>{var n,a,e,d;b.value=!0;try{const{data:l}=await V.get("/users/all",{params:{page:c.value,itemsPerPage:g.value,sortBy:((n=u.value[0])==null?void 0:n.key)||"createdAt",sortOrder:((a=u.value[0])==null?void 0:a.order)==="asc"?1:-1,search:i.value}});f.value.splice(0,f.value.length,...l.result.data),y.value=l.result.total}catch(l){console.log(l);const _=((d=(e=l==null?void 0:l.response)==null?void 0:e.data)==null?void 0:d.message)||"發生錯誤，請稍後再試";p({text:_,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}b.value=!1};r();const k=()=>{c.value=1,r()};return(n,a)=>(U(),A(L,null,[t(G,null,{default:o(()=>[t(x,{cols:"12"},{default:o(()=>[Q]),_:1}),t(x,{cols:"12"},{default:o(()=>[t(M,{"items-per-page":g.value,"onUpdate:itemsPerPage":[a[1]||(a[1]=e=>g.value=e),r],"sort-by":u.value,"onUpdate:sortBy":[a[2]||(a[2]=e=>u.value=e),r],page:c.value,"onUpdate:page":[a[3]||(a[3]=e=>c.value=e),r],items:f.value,headers:P,loading:b.value,"items-length":y.value,search:i.value,hover:""},{top:o(()=>[t(T,{label:"搜尋","append-icon":"mdi-magnify",modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),"onClick:append":k,onKeydown:D(k,["enter"])},null,8,["modelValue"])]),"item.avatar":o(({item:e})=>[t(F,{src:e.avatar,height:"50px",contain:""},null,8,["src"])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"])]),_:1})]),_:1}),t(I,{modelValue:v.value,"onUpdate:modelValue":a[5]||(a[5]=e=>v.value=e),parsistent:"",width:"500px"},{default:o(()=>[t(K,{rounded:"lg"},{default:o(()=>[t(N),t(J,{size:"50",color:"red",class:"ma-auto"},{default:o(()=>[m("mdi-alert")]),_:1}),t(j,{class:"ma-auto"},{default:o(()=>[m("是否刪除 "+q(z(w).value.value)+" 帳號?",1)]),_:1}),t(E,{style:{display:"flex","justify-content":"end"}},{default:o(()=>[t(h,{color:"red",onClick:a[4]||(a[4]=e=>v.value=!1)},{default:o(()=>[m("取消")]),_:1}),t(h,{color:"red",onClick:B},{default:o(()=>[m("確認刪除")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{le as default};
