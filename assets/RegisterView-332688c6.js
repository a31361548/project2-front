import{a8 as q,a9 as $,aa as F,x as w,ab as P,ac as N,ad as l,ai as T,c as r,ae as a,af as E,ag as t,J as I,ah as R,av as z}from"./index-2e906d0c.js";import{v as h}from"./index-3cfa0ab5.js";import{u as A,a as i}from"./vee-validate.esm-018bef8b.js";import{c as D,a as u,b as J,V as O}from"./index.esm-de8aadb6.js";import{V as W}from"./VContainer-451776cb.js";import{V as _}from"./VDivider-bdd82a0d.js";import{V as x}from"./VCol-dc2434c8.js";const j=z("h1",null,"註冊",-1),ee={__name:"RegisterView",setup(G){const y=q(),V=$(),{api:b}=T(),k=F(),m=w(!1),d=w(!1),C=D({account:u().required("帳號為必填欄位").min(4,"使用者帳號長度不符").max(20,"使用者帳號長度不符"),email:u().required("信箱為必填欄位").test("isEmail","信箱格式錯誤",s=>h.isEmail(s)),phone:u().required("手機號碼必填").test("isMobilePhone","格式錯誤",s=>h.isMobilePhone(s,"zh-TW")),password:u().required("密碼為必填欄位").min(4,"密碼長度不符").max(20,"密碼長度不符"),passwordConfirm:u().required("密碼為必填欄位").min(4,"密碼長度不符").max(20,"密碼長度不符").oneOf([J("password")],"密碼不一致")}),{handleSubmit:M,isSubmitting:S}=A({validationSchema:C}),p=i("account"),c=i("email"),v=i("phone"),g=i("password"),f=i("passwordConfirm"),B=M(async s=>{var e,o;try{await b.post("/users",{account:s.account,email:s.email,password:s.password,phone:s.phone}),V({text:"註冊成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}});const{data:n}=await b.post("/users/login",{account:s.account,password:s.password});k.login(n.result),y.push("/")}catch(n){console.log(n);const U=((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.message)||"發生錯誤，請稍後再試";V({text:U,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(s,e)=>(P(),N(W,{style:{"background-color":"white","border-radius":"36px","margin-top":"50px"}},{default:l(()=>[r(x,{cols:"12"},{default:l(()=>[j,r(_)]),_:1}),r(x,{cols:"12"},{default:l(()=>[r(O,{disabled:a(S),onSubmit:E(a(B),["prevent"])},{default:l(()=>[r(t,{label:"帳號",minlength:"4",maxlength:"20",counter:"","prepend-inner-icon":"mdi-account",modelValue:a(p).value.value,"onUpdate:modelValue":e[0]||(e[0]=o=>a(p).value.value=o),"error-messages":a(p).errorMessage.value},null,8,["modelValue","error-messages"]),r(t,{label:"信箱",type:"email","prepend-inner-icon":"mdi-email",modelValue:a(c).value.value,"onUpdate:modelValue":e[1]||(e[1]=o=>a(c).value.value=o),"error-messages":a(c).errorMessage.value},null,8,["modelValue","error-messages"]),r(t,{label:"手機號碼","prepend-inner-icon":"mdi-phone",modelValue:a(v).value.value,"onUpdate:modelValue":e[2]||(e[2]=o=>a(v).value.value=o),"error-messages":a(v).errorMessage.value},null,8,["modelValue","error-messages"]),r(t,{label:"密碼",type:d.value?"text":"password","prepend-inner-icon":"mdi-lock",minlength:"4",maxlength:"20",counter:"",modelValue:a(g).value.value,"onUpdate:modelValue":e[3]||(e[3]=o=>a(g).value.value=o),"append-inner-icon":d.value?"mdi-eye":"mdi-eye-off","onClick:appendInner":e[4]||(e[4]=o=>d.value=!d.value),"error-messages":a(g).errorMessage.value},null,8,["type","modelValue","append-inner-icon","error-messages"]),r(t,{label:"確認密碼",type:m.value?"text":"password","prepend-inner-icon":"mdi-check",minlength:"4",maxlength:"20",counter:"",modelValue:a(f).value.value,"onUpdate:modelValue":e[5]||(e[5]=o=>a(f).value.value=o),"append-icon-inner":m.value?"mdi-eye":"mdi-eye-off","onClick:appendInner":e[6]||(e[6]=o=>m.value=!m.value),"error-messages":a(f).errorMessage.value},null,8,["type","modelValue","append-icon-inner","error-messages"]),r(I,{type:"submit",color:"blue"},{default:l(()=>[R("註冊")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1}))}};export{ee as default};
